{% extends 'base.html' %}
{% load static %}
{% block title %}Home - Basix{% endblock %}
{% block content %}




  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;600;700&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="{% static 'styles.css' %}">


    <!-- Page hero -->
    <section class="page-hero">
      <div class="container">
        <h1 class="page-title">Available Pickups</h1>
        <p class="page-subtitle">Reserve nearby donations and help redistribute surplus food.</p>
      </div>
    </section>

    <!-- Filters/Search -->
    <section class="filters-wrap">
      <div class="container">
        <div class="filters-bar">
          <div class="filter search">
            <input type="text" id="searchInput" placeholder="Search items, e.g. bread, rice..." aria-label="Search">
          </div>

          <div class="filter">
            <label class="filter-label" for="category">Category</label>
            <select id="category">
              <option value="">All</option>
              <option value="Cooked Meals">Cooked Meals</option>
              <option value="Bakery">Bakery</option>
              <option value="Produce">Produce</option>
              <option value="Dairy">Dairy</option>
            </select>
          </div>

          <div class="filter check">
            <label class="checkbox"><input type="checkbox" id="vegOnly"> Veg only</label>
          </div>

          <div class="filter">
            <label class="filter-label" for="sort">Sort by</label>
            <select id="sort">
              <option value="newest">Newest</option>
              <option value="oldest">Oldest</option>
            </select>
          </div>
        </div>
      </div>
    </section>

    <!-- Dynamic Donations Cards -->
    <section class="donations-cards">
      <div class="container cards-grid" id="donations-container">
        <p>Loading donations...</p>
      </div>
    </section>

   
  </div>
<script>
  document.addEventListener("DOMContentLoaded", () => {
    const container = document.getElementById("donations-container");

    function loadDonations() {
      fetch("/api/donations/")
        .then((response) => response.json())
        .then((data) => {
          container.innerHTML = ""; // clear previous
          if (data.donations.length === 0) {
            container.innerHTML = "<p>No donations available right now.</p>";
            return;
          }

          data.donations.forEach((donation) => {
            const card = document.createElement("article");
            card.classList.add("donation-card");

            // Check if donation is reserved
            const isReserved = donation.is_reserved || donation.status === 'reserved' || donation.picked_up_by;
            const reservedBy = donation.picked_up_by || donation.reserved_by;
            
            card.innerHTML = `
              <div class="card-left">
                <img class="thumb" src="${donation.food_image || '/static/default-food.jpg'}" alt="${donation.item_name}">
                ${isReserved ? '<div class="reserved-overlay">RESERVED</div>' : ''}
              </div>
              <div class="card-mid">
                <div class="title-row">
                  <h3 class="item-title">${donation.item_name}</h3>
                  <span class="tag">${donation.food_type}</span>
                  ${isReserved ? '<span class="reserved-tag">Reserved</span>' : ''}
                </div>
                <div class="meta-row">
                  <span class="meta">üìç ${donation.pickup_location}</span>
                  <span class="meta">üïí ${donation.date_available || ''} ${donation.time_available || ''}</span>
                </div>
                <div class="facts-row">
                  <span class="fact">üì¶ ${donation.quantity} ${donation.unit}</span>
                  <span class="fact">üë§ Donor: ${donation.donor_name}</span>
                  ${isReserved && reservedBy ? `<span class="fact">üîí Reserved by: ${reservedBy}</span>` : ''}
                </div>
              </div>
              <div class="card-right">
                <button 
                  class="btn ${isReserved ? 'ghost disabled' : 'primary'} pickup-btn" 
                  data-url="/pickup/${donation.id}/"
                  data-donation-id="${donation.id}"
                  data-is-reserved="${isReserved}"
                  ${isReserved ? 'disabled' : ''}>
                  ${isReserved ? 'Reserved' : 'Pick up'}
                </button>
                <button class="btn ghost details-btn">Details</button>
                <div class="expires">Listed on: ${new Date(donation.created_at).toLocaleDateString()}</div>
              </div>
            `;

            container.appendChild(card);
          });
        })
        .catch((err) => {
          console.error("Error loading donations:", err);
          container.innerHTML = "<p>Failed to load donations.</p>";
        });
    }

    loadDonations();
  });

  // Handle pickup button clicks
  document.addEventListener("click", (e) => {
    if (e.target.classList.contains("pickup-btn")) {
      // Check if donation is reserved
      const isReserved = e.target.dataset.isReserved === 'true';
      
      if (isReserved) {
        // Show reserved popup
        showReservedPopup();
        return;
      }
      
      // Check if user is authenticated
      const isAuthenticated = document.querySelector('.welcome-user') !== null;
      
      if (!isAuthenticated) {
        // User not authenticated, open login modal
        if (typeof openLoginModal === 'function') {
          openLoginModal();
        } else {
          alert('Please login to access this feature');
        }
        return;
      }
      
      // User is authenticated, proceed with pickup
      const url = e.target.dataset.url; // use data-url instead of hardcoding
      const donationId = e.target.dataset.donationId;
      
      // Store the pickup URL for later use
      window.currentPickupUrl = url;
      window.currentDonationId = donationId;
      
      // Open the NGO verification modal
      openPickupModal();
    }
  });

  // Function to open pickup modal
  function openPickupModal() {
    const modal = document.getElementById('pickupModal');
    if (modal) {
      modal.classList.remove('hidden');
      modal.style.display = 'flex';
      modal.style.opacity = '1';
      modal.style.transform = 'scale(1)';
      modal.style.zIndex = '50';
    }
  }

  // Function to close pickup modal
  function closePickupModal() {
    const modal = document.getElementById('pickupModal');
    if (modal) {
      modal.classList.add('hidden');
      modal.style.display = 'none';
    }
  }

  // Function to handle pickup form submission
  function submitPickupForm() {
    const form = document.getElementById('pickupForm');
    
    // Validate form fields
    if (!validatePickupForm()) {
      return;
    }
    
    const formData = new FormData(form);
    
    // Add NGO verification data
    const ngoData = {
      ngo_name: formData.get('ngo_name'),
      ngo_registration: formData.get('ngo_registration'),
      contact_person: formData.get('contact_person'),
      contact_phone: formData.get('contact_phone'),
      ngo_address: formData.get('ngo_address'),
      verification_documents: formData.get('verification_documents')
    };

    // Close modal first
    closePickupModal();

    // Show loading state
    showLoadingState();

    // Submit pickup request with NGO data
    fetch(window.currentPickupUrl, {
      method: "POST",
      headers: {
        "X-CSRFToken": "{{ csrf_token }}",
        "Content-Type": "application/json",
      },
      body: JSON.stringify(ngoData)
    })
    .then(res => res.json())
    .then(data => {
      hideLoadingState();
      if (data.success) {
        showSuccessAnimation();
        setTimeout(() => {
          window.location.href = "/volunteer/";
        }, 3000);
      } else {
        alert(data.error || "Failed to reserve donation.");
      }
    })
    .catch(err => {
      hideLoadingState();
      console.error("Error reserving donation:", err);
      alert("Something went wrong.");
    });
  }

  // Function to validate pickup form
  function validatePickupForm() {
    const form = document.getElementById('pickupForm');
    const requiredFields = [
      { name: 'ngo_name', label: 'NGO Name' },
      { name: 'ngo_registration', label: 'Registration Number' },
      { name: 'contact_person', label: 'Contact Person' },
      { name: 'contact_phone', label: 'Contact Phone' },
      { name: 'ngo_address', label: 'NGO Address' }
    ];

    let isValid = true;
    const errors = [];

    // Clear previous error styles
    form.querySelectorAll('.error').forEach(el => el.classList.remove('error'));
    form.querySelectorAll('.error-message').forEach(el => el.remove());

    // Validate required fields
    requiredFields.forEach(field => {
      const input = form.querySelector(`[name="${field.name}"]`);
      const value = input.value.trim();

      if (!value) {
        isValid = false;
        input.classList.add('error');
        showFieldError(input, `${field.label} is required`);
        errors.push(`${field.label} is required`);
      } else {
        // Additional validation
        if (field.name === 'contact_phone' && !isValidPhone(value)) {
          isValid = false;
          input.classList.add('error');
          showFieldError(input, 'Please enter a valid phone number');
          errors.push('Please enter a valid phone number');
        }
        
        if (field.name === 'ngo_name' && value.length < 3) {
          isValid = false;
          input.classList.add('error');
          showFieldError(input, 'NGO name must be at least 3 characters');
          errors.push('NGO name must be at least 3 characters');
        }
      }
    });

    // Show validation errors
    if (!isValid) {
      showValidationError(errors.join('<br>'));
    }

    return isValid;
  }

  // Function to show field error
  function showFieldError(input, message) {
    const errorDiv = document.createElement('div');
    errorDiv.className = 'error-message';
    errorDiv.textContent = message;
    errorDiv.style.color = '#ef4444';
    errorDiv.style.fontSize = '0.875rem';
    errorDiv.style.marginTop = '0.25rem';
    
    input.parentNode.appendChild(errorDiv);
  }

  // Function to show validation error
  function showValidationError(message) {
    const errorDiv = document.createElement('div');
    errorDiv.id = 'validationError';
    errorDiv.innerHTML = `
      <div class="validation-error-content">
        <div class="error-icon">‚ö†Ô∏è</div>
        <h3>Please fix the following errors:</h3>
        <p>${message}</p>
        <button onclick="closeValidationError()" class="btn primary">OK</button>
      </div>
    `;
    document.body.appendChild(errorDiv);
  }

  // Function to close validation error
  function closeValidationError() {
    const errorDiv = document.getElementById('validationError');
    if (errorDiv) {
      errorDiv.remove();
    }
  }

  // Function to validate phone number
  function isValidPhone(phone) {
    const phoneRegex = /^[\+]?[1-9][\d]{0,15}$/;
    return phoneRegex.test(phone.replace(/[\s\-\(\)]/g, ''));
  }

  // Function to show loading state
  function showLoadingState() {
    const loadingDiv = document.createElement('div');
    loadingDiv.id = 'loadingOverlay';
    loadingDiv.innerHTML = `
      <div class="loading-content">
        <div class="loading-spinner"></div>
        <p>Verifying NGO details...</p>
      </div>
    `;
    document.body.appendChild(loadingDiv);
  }

  // Function to hide loading state
  function hideLoadingState() {
    const loadingDiv = document.getElementById('loadingOverlay');
    if (loadingDiv) {
      loadingDiv.remove();
    }
  }

  // Function to show success animation with confetti
  function showSuccessAnimation() {
    const successDiv = document.createElement('div');
    successDiv.id = 'successAnimation';
    successDiv.innerHTML = `
      <div class="success-content">
        <div class="success-icon">‚úÖ</div>
        <h2>Pickup Confirmed!</h2>
        <p>NGO verification successful. Donation reserved for you!</p>
        <div class="confetti"></div>
      </div>
    `;
    document.body.appendChild(successDiv);

    // Trigger confetti animation
    createConfetti();

    // Remove after 3 seconds
    setTimeout(() => {
      successDiv.remove();
    }, 3000);
  }

  // Function to create confetti effect
  function createConfetti() {
    const colors = ['#009957', '#00C851', '#4CAF50', '#8BC34A', '#CDDC39'];
    const confettiContainer = document.querySelector('.confetti');
    
    for (let i = 0; i < 50; i++) {
      const confetti = document.createElement('div');
      confetti.className = 'confetti-piece';
      confetti.style.left = Math.random() * 100 + '%';
      confetti.style.backgroundColor = colors[Math.floor(Math.random() * colors.length)];
      confetti.style.animationDelay = Math.random() * 2 + 's';
      confetti.style.animationDuration = (Math.random() * 3 + 2) + 's';
      confettiContainer.appendChild(confetti);
    }
  }

  // Function to show reserved popup
  function showReservedPopup() {
    const popupDiv = document.createElement('div');
    popupDiv.id = 'reservedPopup';
    popupDiv.innerHTML = `
      <div class="reserved-popup-content">
        <div class="reserved-icon">üîí</div>
        <h2>Reserved by Someone Else</h2>
        <p>This donation has already been reserved by another volunteer.</p>
        <button onclick="closeReservedPopup()" class="btn primary">OK</button>
      </div>
    `;
    document.body.appendChild(popupDiv);

    // Remove after 5 seconds
    setTimeout(() => {
      if (document.getElementById('reservedPopup')) {
        document.getElementById('reservedPopup').remove();
      }
    }, 5000);
  }

  // Function to close reserved popup
  function closeReservedPopup() {
    const popup = document.getElementById('reservedPopup');
    if (popup) {
      popup.remove();
    }
  }
</script>

<!-- NGO Verification Modal -->
<div id="pickupModal" class="fixed inset-0 bg-black bg-opacity-50 backdrop-blur-sm flex items-center justify-center hidden z-50 transition-opacity duration-500 ease-in-out opacity-0">
  <div class="bg-white rounded-3xl w-full max-w-2xl p-8 relative shadow-2xl transform scale-95 transition-transform duration-500 ease-in-out max-h-[90vh] overflow-y-auto">
    <!-- Close Button -->
    <button onclick="closePickupModal()" class="absolute top-4 right-4 text-gray-400 hover:text-gray-700 text-3xl">&times;</button>

    <!-- Brand Header -->
    <div class="text-center mb-6">
      <div class="flex justify-center mb-4">
        <svg class="w-16 h-16" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 64 64">
          <path d="M32 4C18 12 8 26 8 40c0 10 7 20 24 20s24-10 24-20C56 26 46 12 32 4z" fill="#009957" />
          <path d="M32 12c-6 12-6 28 0 40" stroke="white" stroke-width="3" stroke-linecap="round" />
        </svg>
      </div>
      <h2 class="text-3xl font-bold text-gray-800 mb-2">NGO Verification Required</h2>
      <p class="text-gray-600 text-sm">Please provide your NGO details to confirm pickup eligibility</p>
    </div>

    <!-- NGO Verification Form -->
    <form id="pickupForm" class="space-y-4">
      <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
        <div class="input-group">
          <svg class="icon" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 21V5a2 2 0 00-2-2H7a2 2 0 00-2 2v16m14 0h2m-2 0h-5m-9 0H3m2 0h5M9 7h1m-1 4h1m4-4h1m-1 4h1m-5 10v-5a1 1 0 011-1h2a1 1 0 011 1v5m-4 0h4" />
          </svg>
          <input type="text" name="ngo_name" placeholder="NGO Name" required
                 class="w-full px-4 py-3 border-2 border-gray-200 rounded-xl focus:outline-none focus:ring-2 focus:ring-green-500 focus:border-green-500 transition duration-300 bg-gray-50" />
        </div>

        <div class="input-group">
          <svg class="icon" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z" />
          </svg>
          <input type="text" name="ngo_registration" placeholder="Registration Number" required
                 class="w-full px-4 py-3 border-2 border-gray-200 rounded-xl focus:outline-none focus:ring-2 focus:ring-green-500 focus:border-green-500 transition duration-300 bg-gray-50" />
        </div>
      </div>

      <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
        <div class="input-group">
          <svg class="icon" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z" />
          </svg>
          <input type="text" name="contact_person" placeholder="Contact Person Name" required
                 class="w-full px-4 py-3 border-2 border-gray-200 rounded-xl focus:outline-none focus:ring-2 focus:ring-green-500 focus:border-green-500 transition duration-300 bg-gray-50" />
        </div>

        <div class="input-group">
          <svg class="icon" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 5a2 2 0 012-2h3.28a1 1 0 01.948.684l1.498 4.493a1 1 0 01-.502 1.21l-2.257 1.13a11.042 11.042 0 005.516 5.516l1.13-2.257a1 1 0 011.21-.502l4.493 1.498a1 1 0 01.684.949V19a2 2 0 01-2 2h-1C9.716 21 3 14.284 3 6V5z" />
          </svg>
          <input type="tel" name="contact_phone" placeholder="Contact Phone" required
                 class="w-full px-4 py-3 border-2 border-gray-200 rounded-xl focus:outline-none focus:ring-2 focus:ring-green-500 focus:border-green-500 transition duration-300 bg-gray-50" />
        </div>
      </div>

      <div class="input-group">
        <svg class="icon" fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17.657 16.657L13.414 20.9a1.998 1.998 0 01-2.827 0l-4.244-4.243a8 8 0 1111.314 0z" />
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 11a3 3 0 11-6 0 3 3 0 016 0z" />
        </svg>
        <textarea name="ngo_address" placeholder="NGO Address" required rows="3"
                  class="w-full px-4 py-3 border-2 border-gray-200 rounded-xl focus:outline-none focus:ring-2 focus:ring-green-500 focus:border-green-500 transition duration-300 bg-gray-50 resize-none"></textarea>
      </div>

      <div class="input-group">
        <svg class="icon" fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z" />
        </svg>
        <input type="file" name="verification_documents" accept=".pdf,.jpg,.jpeg,.png" 
               class="w-full px-4 py-3 border-2 border-gray-200 rounded-xl focus:outline-none focus:ring-2 focus:ring-green-500 focus:border-green-500 transition duration-300 bg-gray-50" />
        <label class="text-xs text-gray-500 mt-1">Upload NGO registration certificate (PDF, JPG, PNG)</label>
      </div>

      <div class="flex gap-4 pt-4">
        <button type="button" onclick="closePickupModal()" 
                class="flex-1 py-3 bg-gray-200 text-gray-700 rounded-xl font-semibold hover:bg-gray-300 transition duration-200">
          Cancel
        </button>
        <button type="button" onclick="submitPickupForm()" 
                class="flex-1 py-3 bg-gradient-to-r from-green-600 to-green-700 text-white rounded-xl font-semibold hover:from-green-700 hover:to-green-800 transition transform active:scale-95 shadow-lg">
          Confirm Pickup
        </button>
      </div>
    </form>
  </div>
</div>

<style>
  /* Modal Styles */
  #pickupModal {
    transition: opacity 0.3s ease, transform 0.3s ease;
    z-index: 50;
  }

  #pickupModal:not(.hidden) {
    opacity: 1 !important;
    transform: scale(1) !important;
    display: flex !important;
  }

  #pickupModal.hidden {
    opacity: 0;
    transform: scale(0.95);
    display: none !important;
  }

  /* Input Field Icons */
  .input-group {
    position: relative;
  }

  .input-group input,
  .input-group textarea {
    padding-left: 3rem !important;
  }

  .input-group .icon {
    position: absolute;
    left: 1rem;
    top: 50%;
    transform: translateY(-50%);
    width: 1.25rem;
    height: 1.25rem;
    color: #6b7280;
    z-index: 10;
    pointer-events: none;
  }

  .input-group textarea .icon {
    top: 1.5rem;
    transform: none;
  }

  /* Loading Overlay */
  #loadingOverlay {
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background: rgba(0, 0, 0, 0.8);
    display: flex;
    align-items: center;
    justify-content: center;
    z-index: 100;
  }

  .loading-content {
    text-align: center;
    color: white;
  }

  .loading-spinner {
    width: 50px;
    height: 50px;
    border: 4px solid #f3f3f3;
    border-top: 4px solid #009957;
    border-radius: 50%;
    animation: spin 1s linear infinite;
    margin: 0 auto 20px;
  }

  @keyframes spin {
    0% { transform: rotate(0deg); }
    100% { transform: rotate(360deg); }
  }

  /* Success Animation */
  #successAnimation {
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background: rgba(0, 0, 0, 0.8);
    display: flex;
    align-items: center;
    justify-content: center;
    z-index: 100;
  }

  .success-content {
    text-align: center;
    color: white;
    position: relative;
    background: rgba(255, 255, 255, 0.1);
    padding: 40px;
    border-radius: 20px;
    backdrop-filter: blur(10px);
  }

  .success-icon {
    font-size: 4rem;
    margin-bottom: 20px;
    animation: bounce 0.6s ease-in-out;
  }

  .success-content h2 {
    font-size: 2rem;
    margin-bottom: 10px;
    color: #00C851;
  }

  .success-content p {
    font-size: 1.1rem;
    margin-bottom: 20px;
  }

  @keyframes bounce {
    0%, 20%, 50%, 80%, 100% {
      transform: translateY(0);
    }
    40% {
      transform: translateY(-20px);
    }
    60% {
      transform: translateY(-10px);
    }
  }

  /* Confetti */
  .confetti {
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    overflow: hidden;
    pointer-events: none;
  }

  .confetti-piece {
    position: absolute;
    width: 10px;
    height: 10px;
    background: #009957;
    animation: confetti-fall linear infinite;
  }

  @keyframes confetti-fall {
    0% {
      transform: translateY(-100vh) rotate(0deg);
      opacity: 1;
    }
    100% {
      transform: translateY(100vh) rotate(720deg);
      opacity: 0;
    }
  }

  /* Reserved Status Styles */
  .reserved-overlay {
    position: absolute;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    background: linear-gradient(135deg, rgba(239, 68, 68, 0.9), rgba(220, 38, 38, 0.9));
    display: flex;
    align-items: center;
    justify-content: center;
    color: white;
    font-weight: bold;
    font-size: 1.1rem;
    border-radius: 8px;
    z-index: 10;
    backdrop-filter: blur(2px);
    box-shadow: inset 0 0 20px rgba(0, 0, 0, 0.3);
  }

  .reserved-tag {
    background: linear-gradient(135deg, #ef4444, #dc2626);
    color: white;
    padding: 0.375rem 0.75rem;
    border-radius: 20px;
    font-size: 0.75rem;
    font-weight: 600;
    margin-left: 0.5rem;
    box-shadow: 0 2px 4px rgba(239, 68, 68, 0.3);
    border: 1px solid rgba(255, 255, 255, 0.2);
  }

  .btn.disabled {
    background: linear-gradient(135deg, #f3f4f6, #e5e7eb);
    color: #9ca3af;
    cursor: not-allowed;
    opacity: 0.7;
    border: 1px solid #d1d5db;
    box-shadow: none;
  }

  .btn.disabled:hover {
    background: linear-gradient(135deg, #f3f4f6, #e5e7eb);
    color: #9ca3af;
    transform: none;
    box-shadow: none;
  }

  /* Reserved card styling improvements */
  .donation-card:has(.reserved-overlay) {
    position: relative;
    opacity: 0.85;
    transform: scale(0.98);
    transition: all 0.3s ease;
  }

  .donation-card:has(.reserved-overlay):hover {
    opacity: 0.9;
    transform: scale(0.99);
  }

  .donation-card:has(.reserved-overlay) .card-left {
    filter: grayscale(0.3);
  }

  .donation-card:has(.reserved-overlay) .card-mid {
    position: relative;
  }

  .donation-card:has(.reserved-overlay) .card-mid::before {
    content: '';
    position: absolute;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    background: linear-gradient(135deg, rgba(239, 68, 68, 0.05), rgba(220, 38, 38, 0.05));
    border-radius: 8px;
    z-index: 1;
  }

  .donation-card:has(.reserved-overlay) .card-mid > * {
    position: relative;
    z-index: 2;
  }

  /* Reserved Popup Styles */
  #reservedPopup {
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background: rgba(0, 0, 0, 0.8);
    display: flex;
    align-items: center;
    justify-content: center;
    z-index: 100;
  }

  .reserved-popup-content {
    background: white;
    padding: 2rem;
    border-radius: 16px;
    text-align: center;
    max-width: 400px;
    box-shadow: 0 20px 25px -5px rgba(0, 0, 0, 0.1);
  }

  .reserved-icon {
    font-size: 3rem;
    margin-bottom: 1rem;
  }

  .reserved-popup-content h2 {
    color: #ef4444;
    margin-bottom: 1rem;
    font-size: 1.5rem;
  }

  .reserved-popup-content p {
    color: #6b7280;
    margin-bottom: 1.5rem;
    line-height: 1.5;
  }

  /* Validation Error Styles */
  #validationError {
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background: rgba(0, 0, 0, 0.8);
    display: flex;
    align-items: center;
    justify-content: center;
    z-index: 100;
  }

  .validation-error-content {
    background: white;
    padding: 2rem;
    border-radius: 16px;
    text-align: center;
    max-width: 500px;
    box-shadow: 0 20px 25px -5px rgba(0, 0, 0, 0.1);
  }

  .error-icon {
    font-size: 3rem;
    margin-bottom: 1rem;
  }

  .validation-error-content h3 {
    color: #ef4444;
    margin-bottom: 1rem;
    font-size: 1.5rem;
  }

  .validation-error-content p {
    color: #6b7280;
    margin-bottom: 1.5rem;
    line-height: 1.5;
  }

  /* Form Error Styles */
  .input-group input.error,
  .input-group textarea.error {
    border-color: #ef4444;
    box-shadow: 0 0 0 3px rgba(239, 68, 68, 0.1);
  }

  .error-message {
    color: #ef4444;
    font-size: 0.875rem;
    margin-top: 0.25rem;
  }
</style>

{% endblock %}